<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üïµÔ∏è SECRET AGENT CODE BREAKER üïµÔ∏è</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Share Tech Mono', monospace;
            background: #0a0a0a;
            color: #00ff00;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.15),
                rgba(0, 0, 0, 0.15) 1px,
                transparent 1px,
                transparent 2px
            );
            z-index: 1000;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            border: 2px solid #00ff00;
            padding: 20px;
            margin-bottom: 20px;
            background: rgba(0, 255, 0, 0.05);
        }

        .header h1 {
            font-size: 1.8rem;
            text-shadow: 0 0 10px #00ff00;
            animation: flicker 3s infinite;
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            92% { opacity: 1; }
            93% { opacity: 0.8; }
            94% { opacity: 1; }
            96% { opacity: 0.9; }
            97% { opacity: 1; }
        }

        .clearance {
            font-size: 0.9rem;
            color: #00cc00;
            margin-top: 10px;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            border: 1px solid #00ff00;
            padding: 15px;
            margin-bottom: 20px;
            background: rgba(0, 255, 0, 0.03);
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            color: #00ff00;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #008800;
        }

        .badge-container {
            display: none;
            text-align: center;
            padding: 15px;
            margin-bottom: 20px;
            border: 2px solid;
            animation: pulse 2s infinite;
        }

        .badge-container.agent {
            border-color: #00ff00;
            background: rgba(0, 255, 0, 0.1);
        }

        .badge-container.master {
            border-color: #ff00ff;
            background: rgba(255, 0, 255, 0.1);
        }

        .badge-container.show {
            display: block;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 10px currentColor; }
            50% { box-shadow: 0 0 30px currentColor; }
        }

        .badge-title {
            font-size: 1.3rem;
            margin-bottom: 5px;
        }

        .urgent-alert {
            display: none;
            background: rgba(255, 0, 0, 0.2);
            border: 2px solid #ff0000;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #ff4444;
            animation: blink 0.5s infinite;
        }

        .urgent-alert.show {
            display: block;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .mission-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .mission-btn {
            background: rgba(0, 255, 0, 0.05);
            border: 2px solid #00ff00;
            color: #00ff00;
            padding: 20px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mission-btn:hover {
            background: rgba(0, 255, 0, 0.15);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }

        .mission-btn.active {
            background: rgba(0, 255, 0, 0.2);
        }

        .mission-area {
            border: 2px solid #00ff00;
            padding: 20px;
            min-height: 400px;
            background: rgba(0, 255, 0, 0.02);
        }

        .mission-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            border-bottom: 1px dashed #00ff00;
            padding-bottom: 10px;
        }

        .mission-description {
            font-size: 0.9rem;
            color: #00aa00;
            margin-bottom: 15px;
        }

        .code-display {
            background: #000;
            border: 1px solid #00aa00;
            padding: 20px;
            margin-bottom: 15px;
            font-size: 1.5rem;
            text-align: center;
            letter-spacing: 3px;
            word-break: break-all;
        }

        .legend {
            background: rgba(0, 100, 0, 0.3);
            border: 1px dashed #008800;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 0.85rem;
        }

        .input-area {
            margin-bottom: 15px;
        }

        .input-area input {
            width: 100%;
            background: #000;
            border: 2px solid #00ff00;
            color: #00ff00;
            padding: 15px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 1.2rem;
            text-align: center;
        }

        .input-area input:focus {
            outline: none;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }

        .action-btn {
            width: 100%;
            background: #003300;
            border: 2px solid #00ff00;
            color: #00ff00;
            padding: 15px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 1.2rem;
            cursor: pointer;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .action-btn:hover {
            background: #005500;
        }

        .sound-effect {
            text-align: center;
            min-height: 25px;
            font-size: 0.8rem;
            color: #008800;
            margin-bottom: 10px;
        }

        .result-message {
            text-align: center;
            font-size: 1.5rem;
            padding: 15px;
            margin-bottom: 15px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result-message.success {
            background: rgba(0, 255, 0, 0.2);
            border: 2px solid #00ff00;
            color: #00ff00;
            animation: successPulse 0.5s;
        }

        .result-message.failure {
            background: rgba(255, 0, 0, 0.2);
            border: 2px solid #ff0000;
            color: #ff0000;
            animation: failFlash 0.3s infinite;
        }

        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes failFlash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .attempts-display {
            text-align: center;
            font-size: 1rem;
            color: #00aa00;
            margin-bottom: 10px;
        }

        .attempts-left {
            color: #ffff00;
        }

        .new-mission-btn {
            width: 100%;
            background: #004400;
            border: 2px solid #00aa00;
            color: #00aa00;
            padding: 12px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 1rem;
            cursor: pointer;
            display: none;
        }

        .new-mission-btn.show {
            display: block;
        }

        @media (max-width: 600px) {
            .mission-selector {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="scanlines"></div>

    <div class="container">
        <div class="header">
            <h1>‚ñì‚ñì‚ñì AGENCY CODE BREAKER ‚ñì‚ñì‚ñì</h1>
            <div class="clearance">CLEARANCE: TRAINEE AGENT</div>
        </div>

        <div class="urgent-alert" id="urgentAlert">
            ‚ö† URGENT: NEW INTELLIGENCE RECEIVED ‚ö†
        </div>

        <div class="stats-bar">
            <div class="stat">
                <div class="stat-value" id="missionsCompleted">0</div>
                <div class="stat-label">MISSIONS COMPLETE</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="totalAttempts">0</div>
                <div class="stat-label">ATTEMPTS USED</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="successRate">0%</div>
                <div class="stat-label">SUCCESS RATE</div>
            </div>
        </div>

        <div class="badge-container agent" id="agentBadge">
            <div class="badge-title">üïµÔ∏è SECRET AGENT BADGE üïµÔ∏è</div>
            <div>Congratulations, Agent! You've proven your skills!</div>
        </div>

        <div class="badge-container master" id="masterBadge">
            <div class="badge-title">üïµÔ∏è‚Äç‚ôÇÔ∏èüîç MASTER SPY üîçüïµÔ∏è‚Äç‚ôÇÔ∏è</div>
            <div>Elite status attained! You are a legend of the Agency!</div>
        </div>

        <div class="mission-selector">
            <button class="mission-btn" onclick="startMission('caesar')">MISSION 1<br>CAESAR CIPHER</button>
            <button class="mission-btn" onclick="startMission('reverse')">MISSION 2<br>REVERSE CODE</button>
            <button class="mission-btn" onclick="startMission('number')">MISSION 3<br>NUMBER CODE</button>
            <button class="mission-btn" onclick="startMission('symbol')">MISSION 4<br>SYMBOL SWAP</button>
        </div>

        <div class="mission-area" id="missionArea">
            <div style="text-align: center; padding: 50px; color: #008800;">
                > SELECT A MISSION TO BEGIN<br>
                > GOOD LUCK, AGENT
            </div>
        </div>
    </div>

    <script>
        // Stats
        let stats = JSON.parse(localStorage.getItem('agentStats')) || {
            missionsCompleted: 0,
            totalAttempts: 0,
            successfulAttempts: 0
        };

        let currentMission = null;
        let currentAnswer = '';
        let attemptsLeft = 3;
        let currentSymbolLegend = {};

        // Messages for each mission type
        const messages = {
            caesar: [
                { original: 'SECRET MESSAGE', shift: 3 },
                { original: 'SPY ACTIVATED', shift: 5 },
                { original: 'CODE BREAKER', shift: 2 },
                { original: 'MISSION START', shift: 4 },
                { original: 'AGENT ON DUTY', shift: 3 },
                { original: 'DECODE THIS NOW', shift: 6 },
                { original: 'FIND THE CLUE', shift: 3 },
                { original: 'TRUST NO ONE', shift: 5 },
                { original: 'CLASSIFIED FILE', shift: 2 },
                { original: 'OPERATION GHOST', shift: 4 }
            ],
            reverse: [
                'THE EAGLE HAS LANDED',
                'RED OCTOBER IS HERE',
                'AGENT IN POSITION',
                'MISSION ACCOMPLISHED',
                'EXTRACT AT DAWN',
                'TARGET LOCKED ON',
                'PACKAGE SECURED NOW',
                'ENEMY AGENTS NEARBY',
                'SAFE HOUSE LOCATION',
                'CODE RED ALERT'
            ],
            number: [
                'SPY', 'CODE', 'SECRET', 'AGENT', 'MISSION',
                'TARGET', 'ALERT', 'CLUES', 'TRACE', 'HIDDEN'
            ],
            symbol: [
                'SECRET AGENT', 'CODE BREAKER', 'MISSION GO',
                'SPY VS SPY', 'TOP SECRET', 'ALERT MODE',
                'TRACE TARGET', 'HIDDEN FILE', 'COVERT OP',
                'DECODE ASAP'
            ]
        };

        const symbols = ['@', '#', '$', '%', '^', '&', '*', '+', '=', '?', '~'];

        const urgentMessages = [
            'CODE RED: THE ALIENS ARE LEARNING OUR SECRETS!',
            'ALERT: DOUBLE AGENT DETECTED IN HQ!',
            'URGENT: NEW ENCRYPTION METHOD DISCOVERED!',
            'WARNING: RIVAL AGENCY INTERCEPTING COMMS!',
            'PRIORITY: PRESIDENTIAL CODES AT RISK!',
            'BULLETIN: NEW RECRUIT SHOWING PROMISE!'
        ];

        // Show random urgent alert
        function showUrgentAlert() {
            if (Math.random() < 0.3) {
                const alert = document.getElementById('urgentAlert');
                alert.textContent = '‚ö† ' + urgentMessages[Math.floor(Math.random() * urgentMessages.length)] + ' ‚ö†';
                alert.classList.add('show');
                setTimeout(() => alert.classList.remove('show'), 5000);
            }
        }

        function updateStats() {
            document.getElementById('missionsCompleted').textContent = stats.missionsCompleted;
            document.getElementById('totalAttempts').textContent = stats.totalAttempts;
            const rate = stats.totalAttempts > 0 ? Math.round((stats.successfulAttempts / stats.totalAttempts) * 100) : 0;
            document.getElementById('successRate').textContent = rate + '%';

            // Check badges
            if (stats.missionsCompleted >= 10) {
                document.getElementById('agentBadge').classList.add('show');
            }
            if (stats.missionsCompleted >= 20) {
                document.getElementById('masterBadge').classList.add('show');
            }

            localStorage.setItem('agentStats', JSON.stringify(stats));
        }

        function caesarCipher(str, shift) {
            return str.split('').map(char => {
                if (char >= 'A' && char <= 'Z') {
                    return String.fromCharCode(((char.charCodeAt(0) - 65 + shift) % 26) + 65);
                }
                return char;
            }).join('');
        }

        function numberCode(str) {
            return str.split('').map(char => char.charCodeAt(0) - 64).join('-');
        }

        function createSymbolLegend() {
            const legend = {};
            const usedSymbols = [...symbols].sort(() => Math.random() - 0.5);
            let i = 0;
            for (let c = 65; c <= 90; c++) {
                legend[String.fromCharCode(c)] = usedSymbols[i % usedSymbols.length];
                i++;
            }
            return legend;
        }

        function encodeWithSymbols(str, legend) {
            return str.split('').map(char => {
                return legend[char] || char;
            }).join('');
        }

        function startMission(type) {
            currentMission = type;
            attemptsLeft = 3;
            showUrgentAlert();

            let missionContent = '';
            let hint = '';
            let codeDisplay = '';

            switch(type) {
                case 'caesar': {
                    const msg = messages.caesar[Math.floor(Math.random() * messages.caesar.length)];
                    currentAnswer = msg.original;
                    const encoded = caesarCipher(msg.original, msg.shift);
                    hint = `Each letter has been shifted by ${msg.shift} positions in the alphabet.`;
                    codeDisplay = encoded;
                    break;
                }
                case 'reverse': {
                    const msg = messages.reverse[Math.floor(Math.random() * messages.reverse.length)];
                    currentAnswer = msg;
                    const encoded = msg.split('').reverse().join('');
                    hint = 'The message has been written backwards. Read it from right to left!';
                    codeDisplay = encoded;
                    break;
                }
                case 'number': {
                    const msg = messages.number[Math.floor(Math.random() * messages.number.length)];
                    currentAnswer = msg;
                    const encoded = numberCode(msg);
                    hint = 'A=1, B=2, C=3... Decode the numbers to letters!';
                    codeDisplay = encoded;
                    break;
                }
                case 'symbol': {
                    const msg = messages.symbol[Math.floor(Math.random() * messages.symbol.length)];
                    currentAnswer = msg;
                    currentSymbolLegend = createSymbolLegend();
                    const encoded = encodeWithSymbols(msg, currentSymbolLegend);
                    hint = 'Each letter has been replaced by a symbol. Check the legend below!';
                    codeDisplay = encoded;

                    // Create legend display
                    let legendHTML = '<div class="legend"><strong>SYMBOL LEGEND:</strong><br>';
                    const usedSymbols = new Set(encoded.split('').filter(c => symbols.includes(c)));
                    for (const [letter, symbol] of Object.entries(currentSymbolLegend)) {
                        if (usedSymbols.has(symbol)) {
                            legendHTML += `${letter}=${symbol} `;
                        }
                    }
                    legendHTML += '</div>';
                    hint = legendHTML;
                    break;
                }
            }

            const titles = {
                caesar: 'MISSION 1: CAESAR CIPHER',
                reverse: 'MISSION 2: REVERSE CODE',
                number: 'MISSION 3: NUMBER CODE',
                symbol: 'MISSION 4: SYMBOL SWAP'
            };

            const descriptions = {
                caesar: 'The enemy has used a Caesar shift cipher. Decode the message!',
                reverse: 'The message is backwards! Reverse it to reveal the secret!',
                number: 'Each number represents a letter (A=1, B=2, etc.). Crack the code!',
                symbol: 'Each letter has been swapped with a symbol! Use the legend to decode!'
            };

            document.getElementById('missionArea').innerHTML = `
                <div class="mission-title">${titles[type]}</div>
                <div class="mission-description">${descriptions[type]}</div>
                <div class="attempts-display">ATTEMPTS REMAINING: <span class="attempts-left" id="attemptsLeft">${attemptsLeft}</span></div>
                ${typeof hint === 'string' && hint.includes('legend') ? '' : `<p style="color: #00aa00; margin-bottom: 10px;">${hint}</p>`}
                ${typeof hint !== 'string' ? hint : ''}
                <div class="code-display">${codeDisplay}</div>
                <div class="sound-effect" id="soundEffect"></div>
                <div class="input-area">
                    <input type="text" id="agentInput" placeholder="ENTER DECODED MESSAGE..." autocomplete="off">
                </div>
                <button class="action-btn" onclick="submitAnswer()">DECODE</button>
                <div class="result-message" id="resultMessage"></div>
                <button class="new-mission-btn" id="newMissionBtn" onclick="startMission('${type}')">NEW MISSION</button>
            `;

            // Focus input and add key sound effect
            const input = document.getElementById('agentInput');
            input.focus();
            input.addEventListener('input', () => {
                document.getElementById('soundEffect').textContent = '*KEYCLICK*';
            });

            // Allow Enter key to submit
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') submitAnswer();
            });

            // Remove active class from all buttons and add to current
            document.querySelectorAll('.mission-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function submitAnswer() {
            const input = document.getElementById('agentInput');
            const answer = input.value.toUpperCase().trim();

            if (!answer) return;

            attemptsLeft--;
            stats.totalAttempts++;
            document.getElementById('attemptsLeft').textContent = attemptsLeft;
            document.getElementById('soundEffect').textContent = '*PROCESSING*';

            const resultDiv = document.getElementById('resultMessage');

            if (answer === currentAnswer) {
                // Success!
                stats.missionsCompleted++;
                stats.successfulAttempts++;
                updateStats();

                resultDiv.className = 'result-message success';
                resultDiv.innerHTML = '*ACCESS GRANTED*<br><span style="font-size: 1rem;">MISSION ACCOMPLISHED!</span>';
                document.getElementById('soundEffect').textContent = '*ACCESS GRANTED*';

                document.getElementById('newMissionBtn').classList.add('show');
                input.disabled = true;
            } else if (attemptsLeft <= 0) {
                // Failed
                stats.successfulAttempts = Math.max(0, stats.successfulAttempts - 1);
                updateStats();

                resultDiv.className = 'result-message failure';
                resultDiv.innerHTML = '*ACCESS DENIED*<br><span style="font-size: 1rem;">MISSION FAILED! ANSWER: ${currentAnswer}</span>';
                document.getElementById('soundEffect').textContent = '*ACCESS DENIED*';

                document.getElementById('newMissionBtn').classList.add('show');
                input.disabled = true;
            } else {
                // Wrong but still have attempts
                resultDiv.className = 'result-message';
                resultDiv.style.color = '#ffaa00';
                resultDiv.style.border = '2px solid #ffaa00';
                resultDiv.textContent = 'INCORRECT. TRY AGAIN!';
                document.getElementById('soundEffect').textContent = '*ERROR ERROR*';
                input.value = '';
                input.focus();
            }
        }

        // Initialize
        updateStats();

        // Random urgent alert every 30 seconds
        setInterval(showUrgentAlert, 30000);
    </script>
</body>
</html>